# Архитектура

Xart состоит из двух основных частей: фронтенда (Vue 3) и бэкенда (Go). Фронтенд общается с бэкендом по относительным путям `/api`, а бэкенд проксирует запросы во внешний API anixart.

## Компоненты

### Frontend
- SPA-приложение на Vue 3 с Composition API и TypeScript.
- Состояние хранится в Pinia, есть сохранение состояния через `pinia-plugin-persistedstate`.
- Сборка и дев-сервер на Vite.
- Включена PWA-конфигурация через `vite-plugin-pwa`.

### Backend
- HTTP-сервер на Go.
- Отдает служебные эндпоинты и проксирует запросы во внешний API.
- Имеет отдельный прокси для изображений с whitelist доменов.

## Поток данных

1. Браузер загружает фронтенд.
2. Фронтенд делает запросы на `/api/...`.
3. Vite в dev-режиме проксирует `/api` на бэкенд `http://localhost:8080`.
4. Бэкенд обрабатывает запрос и, если это прокси, пересылает его во внешний API.
5. Ответ возвращается во фронтенд без изменения тела.

## PWA

PWA включена через `vite-plugin-pwa`.
- Service Worker регистрируется автоматически.
- Навигационные запросы имеют fallback на `/index.html`.
- Путь `/api/*` исключен из fallback.

## Границы безопасности

- Прокси изображений принимает только `http/https` URL и разрешенные домены `*.anixmirai.com` и `*.anixsekai.com`.
- CORS на бэкенде настраивается через переменную окружения `CORS_ORIGIN`.
